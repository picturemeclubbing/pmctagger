# PMC REVAMP ‚Äî PHASE 1: FOUNDATION & CORE INFRASTRUCTURE
## Generated by Claude (Architect AI)
## Date: 2025-10-11

---

### FILE: /package.json
// File: /package.json
// Purpose: Project dependencies and scripts for Vite + React + Dexie + Tailwind
// Connects to: All project files

```json
{
  "name": "pmc-revamp",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext js,jsx"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0",
    "dexie": "^3.2.4",
    "dexie-react-hooks": "^1.1.7"
  },
  "devDependencies": {
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@vitejs/plugin-react": "^4.2.1",
    "autoprefixer": "^10.4.16",
    "eslint": "^8.55.0",
    "eslint-plugin-react": "^7.33.2",
    "eslint-plugin-react-hooks": "^4.6.0",
    "postcss": "^8.4.32",
    "tailwindcss": "^3.3.6",
    "vite": "^5.0.8"
  }
}
```

---

### FILE: /vite.config.js
// File: /vite.config.js
// Purpose: Vite configuration for React app with optimized build settings
// Connects to: main.jsx, index.html

```javascript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    open: true
  },
  build: {
    outDir: 'dist',
    sourcemap: true
  }
});
```

---

### FILE: /tailwind.config.js
// File: /tailwind.config.js
// Purpose: Tailwind CSS configuration with custom theme for PMC branding
// Connects to: index.css, all component files

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,jsx,ts,tsx}"
  ],
  theme: {
    extend: {
      colors: {
        primary: '#3B82F6',
        secondary: '#8B5CF6',
        success: '#10B981',
        warning: '#F59E0B',
        danger: '#EF4444'
      }
    }
  },
  plugins: []
};
```

---

### FILE: /postcss.config.js
// File: /postcss.config.js
// Purpose: PostCSS configuration for Tailwind processing
// Connects to: tailwind.config.js

```javascript
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {}
  }
};
```

---

### FILE: /index.html
// File: /index.html
// Purpose: HTML entry point for Vite app
// Connects to: main.jsx

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="PMC Revamp - Photo Tagging and Delivery System" />
    <title>PMC Revamp</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
```

---

### FILE: /src/main.jsx
// File: /src/main.jsx
// Purpose: React application entry point with strict mode
// Connects to: App.jsx, index.css

```javascript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

---

### FILE: /src/index.css
// File: /src/index.css
// Purpose: Global styles and Tailwind directives
// Connects to: tailwind.config.js

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #f9fafb;
}

#root {
  min-height: 100vh;
}
```

---

### FILE: /src/App.jsx
// File: /src/App.jsx
// Purpose: Root component with React Router setup and global debug initialization
// Connects to: All page components, Layout.jsx, debugger.js

```javascript
import React, { useEffect } from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import Layout from './components/Layout';
import UploadPage from './pages/UploadPage';
import TaggingPage from './pages/TaggingPage';
import SharePage from './pages/SharePage';
import GalleryPage from './pages/GalleryPage';
import CRMPage from './pages/CRMPage';
import SettingsPage from './pages/SettingsPage';
import DebugPage from './pages/DebugPage';
import { initDebugger } from './services/debugger';

function App() {
  useEffect(() => {
    // Initialize debug system on app mount
    initDebugger();
    console.log('PMC Revamp App Initialized');
  }, []);

  return (
    <BrowserRouter>
      <Layout>
        <Routes>
          <Route path="/" element={<Navigate to="/gallery" replace />} />
          <Route path="/upload" element={<UploadPage />} />
          <Route path="/tag/:sessionId" element={<TaggingPage />} />
          <Route path="/share/:sessionId" element={<SharePage />} />
          <Route path="/gallery" element={<GalleryPage />} />
          <Route path="/crm" element={<CRMPage />} />
          <Route path="/settings" element={<SettingsPage />} />
          <Route path="/debug" element={<DebugPage />} />
          <Route path="*" element={<Navigate to="/gallery" replace />} />
        </Routes>
      </Layout>
    </BrowserRouter>
  );
}

export default App;
```

---

### FILE: /src/services/constants.js
// File: /src/services/constants.js
// Purpose: App-wide constants for status codes, file limits, and debug event types
// Connects to: All service and component files

```javascript
// Session Status Constants
export const SESSION_STATUS = {
  RAW: 'raw',
  TAGGED: 'tagged',
  SHARED: 'shared',
  SENT: 'sent'
};

// File Upload Constants
export const FILE_LIMITS = {
  MAX_SIZE_MB: 10,
  MAX_SIZE_BYTES: 10 * 1024 * 1024,
  ALLOWED_TYPES: ['image/jpeg', 'image/jpg', 'image/png'],
  ALLOWED_EXTENSIONS: ['.jpg', '.jpeg', '.png']
};

// Image Processing Constants
export const IMAGE_CONFIG = {
  THUMBNAIL_MAX_WIDTH: 300,
  THUMBNAIL_MAX_HEIGHT: 300,
  PREVIEW_MAX_WIDTH: 1200,
  PREVIEW_MAX_HEIGHT: 1200,
  QUALITY: 0.85
};

// Debug Event Types
export const DEBUG_EVENTS = {
  // Upload Events
  UPLOAD_START: 'UPLOAD_START',
  UPLOAD_SUCCESS: 'UPLOAD_SUCCESS',
  UPLOAD_ERROR: 'UPLOAD_ERROR',
  IMAGE_COMPRESSED: 'IMAGE_COMPRESSED',
  SESSION_CREATED: 'SESSION_CREATED',
  
  // Tagging Events
  TAG_ADDED: 'TAG_ADDED',
  TAG_MOVED: 'TAG_MOVED',
  TAG_SAVED: 'TAG_SAVED',
  TAG_ERROR: 'TAG_ERROR',
  TAG_SESSION_COMPLETE: 'TAG_SESSION_COMPLETE',
  
  // Share Events
  SHARE_START: 'SHARE_START',
  SHARE_SUCCESS: 'SHARE_SUCCESS',
  SHARE_ERROR: 'SHARE_ERROR',
  SHARE_TAGGED: 'SHARE_TAGGED',
  SHARE_UNTAGGED: 'SHARE_UNTAGGED',
  COMMENT_COPIED: 'COMMENT_COPIED',
  WATERMARK_APPLIED: 'WATERMARK_APPLIED',
  
  // Gallery Events
  GALLERY_LOAD: 'GALLERY_LOAD',
  GALLERY_REFRESH: 'GALLERY_REFRESH',
  GALLERY_ERROR: 'GALLERY_ERROR',
  SESSION_VIEWED: 'SESSION_VIEWED',
  SESSION_TOGGLED: 'SESSION_TOGGLED',
  SESSION_DELETED: 'SESSION_DELETED',
  
  // CRM Events
  CUSTOMER_UPDATED: 'CUSTOMER_UPDATED',
  CUSTOMER_DELIVERED: 'CUSTOMER_DELIVERED',
  CUSTOMER_SYNCED: 'CUSTOMER_SYNCED',
  CRM_UPDATE: 'CRM_UPDATE',
  CRM_SYNC_ERROR: 'CRM_SYNC_ERROR',
  
  // Delivery Events
  DELIVERY_QUEUED: 'DELIVERY_QUEUED',
  DELIVERY_START: 'DELIVERY_START',
  DELIVERY_SUCCESS: 'DELIVERY_SUCCESS',
  DELIVERY_FAIL: 'DELIVERY_FAIL',
  DELIVERY_RETRY: 'DELIVERY_RETRY',
  SEND_INITIATED: 'SEND_INITIATED',
  
  // Settings Events
  SETTINGS_SAVED: 'SETTINGS_SAVED',
  SETTINGS_LOADED: 'SETTINGS_LOADED',
  SETTINGS_ERROR: 'SETTINGS_ERROR',
  
  // System Events
  DB_INIT: 'DB_INIT',
  DB_ERROR: 'DB_ERROR',
  ROUTE_CHANGE: 'ROUTE_CHANGE'
};

// Tag Default Settings
export const TAG_DEFAULTS = {
  FONT_SIZE: 24,
  FONT_FAMILY: 'Arial, sans-serif',
  COLOR: '#FFFFFF',
  BACKGROUND_COLOR: 'rgba(0, 0, 0, 0.6)',
  POSITION_X: 50,
  POSITION_Y: 50
};

// Delivery Settings
export const DELIVERY_CONFIG = {
  MAX_RETRIES: 3,
  RETRY_DELAY_MS: 5000,
  TIMEOUT_MS: 30000
};

export default {
  SESSION_STATUS,
  FILE_LIMITS,
  IMAGE_CONFIG,
  DEBUG_EVENTS,
  TAG_DEFAULTS,
  DELIVERY_CONFIG
};
```

---

### FILE: /src/services/database.js
// File: /src/services/database.js
// Purpose: Dexie database initialization with schema for sessions, tags, customers, delivery queue, and settings
// Connects to: All pages and components that read/write data

```javascript
import Dexie from 'dexie';
import { logDebug } from './debugger';
import { DEBUG_EVENTS } from './constants';

// Initialize Dexie database
export const db = new Dexie('PMCRevampDB');

// Define database schema
db.version(1).stores({
  sessions: '++id, sessionId, fileName, uploadDate, status, *tags',
  tags_meta: '++id, sessionId, tagId, text, x, y, fontSize, color, fontFamily',
  customers: '++id, name, phone, email, lastDelivery, status',
  delivery_queue: '++id, sessionId, customerId, status, queuedAt, sentAt, retryCount',
  settings: 'key, value'
});

// Database initialization
db.on('ready', () => {
  logDebug(DEBUG_EVENTS.DB_INIT, { message: 'Database initialized successfully' });
});

db.on('error', (error) => {
  logDebug(DEBUG_EVENTS.DB_ERROR, { error: error.message });
});

// ===== SESSION CRUD OPERATIONS =====

/**
 * Save raw version of uploaded image
 * @param {Object} sessionData - Session metadata
 * @returns {Promise<number>} Session ID
 */
export async function saveRawVersion(sessionData) {
  try {
    const id = await db.sessions.add({
      sessionId: sessionData.sessionId,
      fileName: sessionData.fileName,
      rawImage: sessionData.rawImage,
      thumbnail: sessionData.thumbnail,
      uploadDate: new Date().toISOString(),
      status: 'raw',
      tags: []
    });
    
    logDebug(DEBUG_EVENTS.SESSION_CREATED, { sessionId: sessionData.sessionId });
    return id;
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'saveRawVersion', error: error.message });
    throw error;
  }
}

/**
 * Get session by sessionId
 * @param {string} sessionId
 * @returns {Promise<Object|null>}
 */
export async function getSession(sessionId) {
  try {
    return await db.sessions.where('sessionId').equals(sessionId).first();
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getSession', error: error.message });
    return null;
  }
}

/**
 * Get all sessions
 * @returns {Promise<Array>}
 */
export async function getAllSessions() {
  try {
    return await db.sessions.orderBy('uploadDate').reverse().toArray();
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getAllSessions', error: error.message });
    return [];
  }
}

/**
 * Update session status
 * @param {string} sessionId
 * @param {string} status
 */
export async function updateSessionStatus(sessionId, status) {
  try {
    await db.sessions.where('sessionId').equals(sessionId).modify({ status });
    logDebug(DEBUG_EVENTS.SESSION_TOGGLED, { sessionId, status });
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'updateSessionStatus', error: error.message });
    throw error;
  }
}

/**
 * Delete session
 * @param {string} sessionId
 */
export async function deleteSession(sessionId) {
  try {
    await db.sessions.where('sessionId').equals(sessionId).delete();
    await db.tags_meta.where('sessionId').equals(sessionId).delete();
    logDebug(DEBUG_EVENTS.SESSION_DELETED, { sessionId });
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'deleteSession', error: error.message });
    throw error;
  }
}

// ===== TAG METADATA OPERATIONS =====

/**
 * Save tag metadata
 * @param {Object} tagData
 */
export async function saveTagMeta(tagData) {
  try {
    await db.tags_meta.add(tagData);
    logDebug(DEBUG_EVENTS.TAG_SAVED, { sessionId: tagData.sessionId, tagId: tagData.tagId });
  } catch (error) {
    logDebug(DEBUG_EVENTS.TAG_ERROR, { operation: 'saveTagMeta', error: error.message });
    throw error;
  }
}

/**
 * Get all tags for a session
 * @param {string} sessionId
 * @returns {Promise<Array>}
 */
export async function getTagsForSession(sessionId) {
  try {
    return await db.tags_meta.where('sessionId').equals(sessionId).toArray();
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getTagsForSession', error: error.message });
    return [];
  }
}

/**
 * Update tag metadata
 * @param {number} tagId
 * @param {Object} updates
 */
export async function updateTagMeta(tagId, updates) {
  try {
    await db.tags_meta.update(tagId, updates);
    logDebug(DEBUG_EVENTS.TAG_MOVED, { tagId, updates });
  } catch (error) {
    logDebug(DEBUG_EVENTS.TAG_ERROR, { operation: 'updateTagMeta', error: error.message });
    throw error;
  }
}

/**
 * Delete tag
 * @param {number} tagId
 */
export async function deleteTag(tagId) {
  try {
    await db.tags_meta.delete(tagId);
  } catch (error) {
    logDebug(DEBUG_EVENTS.TAG_ERROR, { operation: 'deleteTag', error: error.message });
    throw error;
  }
}

// ===== CUSTOMER OPERATIONS =====

/**
 * Add or update customer
 * @param {Object} customerData
 */
export async function saveCustomer(customerData) {
  try {
    const existing = await db.customers
      .where('phone')
      .equals(customerData.phone)
      .first();
    
    if (existing) {
      await db.customers.update(existing.id, customerData);
    } else {
      await db.customers.add(customerData);
    }
    
    logDebug(DEBUG_EVENTS.CUSTOMER_UPDATED, { customer: customerData.name });
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'saveCustomer', error: error.message });
    throw error;
  }
}

/**
 * Get all customers
 * @returns {Promise<Array>}
 */
export async function getAllCustomers() {
  try {
    return await db.customers.toArray();
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getAllCustomers', error: error.message });
    return [];
  }
}

// ===== DELIVERY QUEUE OPERATIONS =====

/**
 * Add delivery to queue
 * @param {Object} deliveryData
 */
export async function queueDelivery(deliveryData) {
  try {
    await db.delivery_queue.add({
      ...deliveryData,
      queuedAt: new Date().toISOString(),
      status: 'queued',
      retryCount: 0
    });
    logDebug(DEBUG_EVENTS.DELIVERY_QUEUED, { sessionId: deliveryData.sessionId });
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'queueDelivery', error: error.message });
    throw error;
  }
}

/**
 * Get pending deliveries
 * @returns {Promise<Array>}
 */
export async function getPendingDeliveries() {
  try {
    return await db.delivery_queue
      .where('status')
      .equals('queued')
      .toArray();
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getPendingDeliveries', error: error.message });
    return [];
  }
}

/**
 * Update delivery status
 * @param {number} deliveryId
 * @param {string} status
 */
export async function updateDeliveryStatus(deliveryId, status) {
  try {
    await db.delivery_queue.update(deliveryId, {
      status,
      sentAt: status === 'sent' ? new Date().toISOString() : undefined
    });
    
    if (status === 'sent') {
      logDebug(DEBUG_EVENTS.DELIVERY_SUCCESS, { deliveryId });
    } else if (status === 'failed') {
      logDebug(DEBUG_EVENTS.DELIVERY_FAIL, { deliveryId });
    }
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'updateDeliveryStatus', error: error.message });
    throw error;
  }
}

// ===== SETTINGS OPERATIONS =====

/**
 * Save setting
 * @param {string} key
 * @param {any} value
 */
export async function saveSetting(key, value) {
  try {
    await db.settings.put({ key, value });
    logDebug(DEBUG_EVENTS.SETTINGS_SAVED, { key });
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'saveSetting', error: error.message });
    throw error;
  }
}

/**
 * Get setting
 * @param {string} key
 * @returns {Promise<any>}
 */
export async function getSetting(key) {
  try {
    const result = await db.settings.get(key);
    return result ? result.value : null;
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getSetting', error: error.message });
    return null;
  }
}

/**
 * Get all settings
 * @returns {Promise<Object>}
 */
export async function getAllSettings() {
  try {
    const settings = await db.settings.toArray();
    return settings.reduce((acc, { key, value }) => {
      acc[key] = value;
      return acc;
    }, {});
  } catch (error) {
    logDebug(DEBUG_EVENTS.DB_ERROR, { operation: 'getAllSettings', error: error.message });
    return {};
  }
}

export default db;
```

---

### FILE: /src/services/debugger.js
// File: /src/services/debugger.js
// Purpose: Debug logging system with event tracking and console output
// Connects to: All components and services, DebugConsole.jsx

```javascript
import { DEBUG_EVENTS } from './constants';

// In-memory log storage
let debugLogs = [];
let debugEnabled = true;
let listeners = [];

/**
 * Initialize debugger system
 */
export function initDebugger() {
  debugLogs = [];
  debugEnabled = true;
  
  // Add keyboard shortcut for debug toggle (Ctrl+Shift+D)
  if (typeof window !== 'undefined') {
    window.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.shiftKey && e.key === 'D') {
        debugEnabled = !debugEnabled;
        console.log(`Debug mode ${debugEnabled ? 'enabled' : 'disabled'}`);
      }
    });
  }
  
  logDebug('SYSTEM', { message: 'Debugger initialized' });
}

/**
 * Log debug event
 * @param {string} eventType - Event type from DEBUG_EVENTS
 * @param {Object} data - Event data
 */
export function logDebug(eventType, data = {}) {
  if (!debugEnabled) return;
  
  const logEntry = {
    id: Date.now() + Math.random(),
    timestamp: new Date().toISOString(),
    eventType,
    data,
    component: data.component || 'UNKNOWN'
  };
  
  debugLogs.push(logEntry);
  
  // Keep only last 500 logs to prevent memory issues
  if (debugLogs.length > 500) {
    debugLogs = debugLogs.slice(-500);
  }
  
  // Console output with color coding
  const consoleStyle = getConsoleStyle(eventType);
  console.log(
    `%c[${eventType}]`,
    consoleStyle,
    new Date().toLocaleTimeString(),
    data
  );
  
  // Notify listeners
  notifyListeners(logEntry);
}

/**
 * Get all debug logs
 * @returns {Array} Array of log entries
 */
export function getDebugLogs() {
  return [...debugLogs];
}

/**
 * Clear all debug logs
 */
export function clearDebugLogs() {
  debugLogs = [];
  notifyListeners({ type: 'CLEAR' });
}

/**
 * Subscribe to debug log updates
 * @param {Function} callback
 * @returns {Function} Unsubscribe function
 */
export function subscribeToDebugLogs(callback) {
  listeners.push(callback);
  return () => {
    listeners = listeners.filter(cb => cb !== callback);
  };
}

/**
 * Notify all listeners of log update
 * @param {Object} logEntry
 */
function notifyListeners(logEntry) {
  listeners.forEach(callback => callback(logEntry));
}

/**
 * Get console style based on event type
 * @param {string} eventType
 * @returns {string} CSS style string
 */
function getConsoleStyle(eventType) {
  const styles = {
    UPLOAD: 'color: #3B82F6; font-weight: bold',
    TAG: 'color: #8B5CF6; font-weight: bold',
    SHARE: 'color: #10B981; font-weight: bold',
    GALLERY: 'color: #F59E0B; font-weight: bold',
    CRM: 'color: #EC4899; font-weight: bold',
    DELIVERY: 'color: #06B6D4; font-weight: bold',
    SETTINGS: 'color: #6366F1; font-weight: bold',
    ERROR: 'color: #EF4444; font-weight: bold',
    SUCCESS: 'color: #10B981; font-weight: bold',
    DB: 'color: #8B5CF6; font-weight: bold',
    SYSTEM: 'color: #6B7280; font-weight: bold'
  };
  
  for (const [key, style] of Object.entries(styles)) {
    if (eventType.includes(key)) {
      return style;
    }
  }
  
  return 'color: #6B7280; font-weight: bold';
}

/**
 * Export logs to text file
 * @returns {string} Formatted log text
 */
export function exportLogsToText() {
  const header = `PMC REVAMP DEBUG LOGS\nExported: ${new Date().toISOString()}\n${'='.repeat(60)}\n\n`;
  
  const logText = debugLogs.map(log => {
    return `[${log.timestamp}] ${log.eventType}\n${JSON.stringify(log.data, null, 2)}\n`;
  }).join('\n');
  
  return header + logText;
}

/**
 * Download logs as text file
 */
export function downloadDebugLogs() {
  const logText = exportLogsToText();
  const blob = new Blob([logText], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `pmc-debug-logs-${Date.now()}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

/**
 * Filter logs by event type
 * @param {string} eventType
 * @returns {Array}
 */
export function filterLogsByEventType(eventType) {
  return debugLogs.filter(log => log.eventType.includes(eventType));
}

/**
 * Get logs by time range
 * @param {Date} startTime
 * @param {Date} endTime
 * @returns {Array}
 */
export function getLogsByTimeRange(startTime, endTime) {
  return debugLogs.filter(log => {
    const logTime = new Date(log.timestamp);
    return logTime >= startTime && logTime <= endTime;
  });
}

export default {
  initDebugger,
  logDebug,
  getDebugLogs,
  clearDebugLogs,
  subscribeToDebugLogs,
  exportLogsToText,
  downloadDebugLogs,
  filterLogsByEventType,
  getLogsByTimeRange
};
```

---

### FILE: /src/components/Layout.jsx
// File: /src/components/Layout.jsx
// Purpose: Main layout wrapper with navigation and debug console toggle
// Connects to: App.jsx, Navigation.jsx, DebugConsole.jsx

```javascript
import React, { useState } from 'react';
import Navigation from './Navigation';
import DebugConsole from './DebugConsole';

function Layout({ children }) {
  const [showDebug, setShowDebug] = useState(false);

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Navigation Bar */}
      <Navigation onDebugToggle={() => setShowDebug(!showDebug)} />
      
      {/* Main Content */}
      <main className="container mx-auto px-4 py-6">
        {children}
      </main>
      
      {/* Debug Console Overlay */}
      {showDebug && (
        <DebugConsole onClose={() => setShowDebug(false)} />
      )}
    </div>
  );
}

export default Layout;
```

---

### FILE: /src/components/Navigation.jsx
// File: /src/components/Navigation.jsx
// Purpose: Top navigation bar with route links and debug toggle
// Connects to: Layout.jsx, react-router-dom

```javascript
import React from 'react';
import { NavLink } from 'react-router-dom';

function Navigation({ onDebugToggle }) {
  const navLinks = [
    { path: '/gallery', label: 'Gallery', icon: 'üñºÔ∏è' },
    { path: '/upload', label: 'Upload', icon: '‚¨ÜÔ∏è' },
    { path: '/crm', label: 'CRM', icon: 'üë•' },
    { path: '/settings', label: 'Settings', icon: '‚öôÔ∏è' }
  ];

  return (
    <nav className="bg-white shadow-md border-b border-gray-200">
      <div className="container mx-auto px-4">
        <div className="flex items-center justify-between h-16">
          {/* Logo */}
          <div className="flex items-center space-x-2">
            <span className="text-2xl font-bold text-primary">üì∏</span>
            <span className="text-xl font-bold text-gray-800">PMC Revamp</span>
          </div>
          
          {/* Navigation Links */}
          <div className="flex items-center space-x-1">
            {navLinks.map(link => (
              <NavLink
                key={link.path}
                to={link.path}
                className={({ isActive }) =>
                  `px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                    isActive
                      ? 'bg-primary text-white'
                      : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'
                  }`
                }
              >
                <span className="mr-2">{link.icon}</span>
                {link.label}
              </NavLink>
            ))}
            
            {/* Debug Toggle Button */}
            <button
              onClick={onDebugToggle}
              className="ml-4 px-4 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 transition-colors"
              title="Toggle Debug Console (Ctrl+Shift+D)"
            >
              üêõ Debug
            </button>
          </div>
        </div>
      </div>
    </nav>
  );
}

export default Navigation;
```

---

### FILE: /src/components/DebugConsole.jsx
// File: /src/components/DebugConsole.jsx
// Purpose: Real-time debug console overlay with log filtering and export
// Connects to: debugger.js, Layout.jsx

```javascript
import React, { useState, useEffect } from 'react';
import {
  getDebugLogs,
  clearDebugLogs,
  downloadDebugLogs,
  subscribeToDebugLogs
} from '../services/debugger';

function DebugConsole({ onClose }) {
  const [logs, setLogs] = useState(getDebugLogs());
  const [filter, setFilter] = useState('ALL');
  const [autoScroll, setAutoScroll] = useState(true);

  useEffect(() => {
    // Subscribe to new logs
    const unsubscribe = subscribeToDebugLogs((logEntry) => {
      if (logEntry.type === 'CLEAR') {
        setLogs([]);
      } else {
        setLogs(getDebugLogs());
      }
    });

    return unsubscribe;
  }, []);

  useEffect(() => {
    if (autoScroll) {
      const logContainer = document.getElementById('debug-log-container');
      if (logContainer) {
        logContainer.scrollTop = logContainer.scrollHeight;
      }
    }
  }, [logs, autoScroll]);

  const filteredLogs = filter === 'ALL'
    ? logs
    : logs.filter(log => log.eventType.includes(filter));

  const filterOptions = [
    'ALL',
    'UPLOAD',
    'TAG',
    'SHARE',
    'GALLERY',
    'CRM',
    'DELIVERY',
    'SETTINGS',
    'ERROR'
  ];

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center">
      <div className="bg-white w-full h-2/3 rounded-t-lg shadow-2xl flex flex-col">
        {/* Header */}
        <div className="bg-gray-800 text-white px-4 py-3 flex items-center justify-between rounded-t-lg">
          <div className="flex items-center space-x-4">
            <h2 className="text-lg font-bold">üêõ Debug Console</h2>
            <span className="text-sm text-gray-300">
              {filteredLogs.length} logs
            </span>
          </div>
          
          <div className="flex items-center space-x-2">
            {/* Filter Dropdown */}
            <select
              value={filter}
              onChange={(e) => setFilter(e.target.value)}
              className="bg-gray-700 text-white px-3 py-1 rounded text-sm"
            >
              {filterOptions.map(option => (
                <option key={option} value={option}>
                  {option}
                </option>
              ))}
            </select>
            
            {/* Auto-scroll Toggle */}
            <button
              onClick={() => setAutoScroll(!autoScroll)}
              className={`px-3 py-1 rounded text-sm ${
                autoScroll ? 'bg-green-600' : 'bg-gray-600'
              }`}
            >
              Auto-scroll: {autoScroll ? 'ON' : 'OFF'}
            </button>
            
            {/* Clear Logs */}
            <button
              onClick={clearDebugLogs}
              className="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm"
            >
              Clear
            </button>
            
            {/* Export Logs */}
            <button
              onClick={downloadDebugLogs}
              className="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm"
            >
              Export
            </button>
            
            {/* Close Button */}
            <button
              onClick={onClose}
              className="bg-gray-600 hover:bg-gray-700 px-3 py-1 rounded text-sm"
            >
              Close
            </button>
          </div>
        </div>
        
        {/* Log Container */}
        <div
          id="debug-log-container"
          className="flex-1 overflow-y-auto bg-gray-900 text-gray-100 p-4 font-mono text-xs"
        >
          {filteredLogs.length === 0 ? (
            <div className="text-gray-500 text-center mt-8">
              No logs to display
            </div>
          ) : (
            filteredLogs.map(log => (
              <div
                key={log.id}
                className="mb-3 pb-3 border-b border-gray-700"
              >
                <div className="flex items-center space-x-2 mb-1">
                  <span className="text-gray-500">
                    {new Date(log.timestamp).toLocaleTimeString()}
                  </span>
                  <span className={`font-bold ${getEventColor(log.eventType)}`}>
                    [{log.eventType}]
                  </span>
                </div>
                <pre className="text-gray-300 whitespace-pre-wrap">
                  {JSON.stringify(log.data, null, 2)}
                </pre>
              </div>
            ))
          )}
        </div>
      </div>
    </div>
  );
}

function getEventColor(eventType) {
  if (eventType.includes('ERROR')) return 'text-red-400';
  if (eventType.includes('SUCCESS')) return 'text-green-400';
  if (eventType.includes('UPLOAD')) return 'text-blue-400';
  if (eventType.includes('TAG')) return 'text-purple-400';
  if (eventType.includes('SHARE')) return 'text-green-400';
  if (eventType.includes('GALLERY')) return 'text-yellow-400';
  if (eventType.includes('CRM')) return 'text-pink-400';
  if (eventType.includes('DELIVERY')) return 'text-cyan-400';
  return 'text-gray-400';
}

export default DebugConsole;
```

---

### FILE: /src/pages/UploadPage.jsx
// File: /src/pages/UploadPage.jsx
// Purpose: Image upload interface with drag-and-drop support (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';

function UploadPage() {
  return (
    <div className="max-w-4xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">
          üì§ Upload Photos
        </h1>
        
        <div className="border-4 border-dashed border-gray-300 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üì∏</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Upload Page - Coming in Phase 2
          </h2>
          <p className="text-gray-500">
            Drag and drop photos here or click to browse
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 2 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Drag-and-drop file upload</li>
            <li>Image compression and thumbnail generation</li>
            <li>Progress tracking</li>
            <li>Session creation and navigation to tagging</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default UploadPage;
```

---

### FILE: /src/pages/TaggingPage.jsx
// File: /src/pages/TaggingPage.jsx
// Purpose: Interactive photo tagging interface (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';
import { useParams } from 'react-router-dom';

function TaggingPage() {
  const { sessionId } = useParams();

  return (
    <div className="max-w-6xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">
          üè∑Ô∏è Tagging Page
        </h1>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üé®</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Tagging Interface - Coming in Phase 3
          </h2>
          <p className="text-gray-500 mb-4">
            Session ID: <code className="bg-white px-2 py-1 rounded">{sessionId}</code>
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 3 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Full-screen canvas with image display</li>
            <li>Draggable Instagram-style tags</li>
            <li>Live text editing on canvas</li>
            <li>Tag position and style metadata storage</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default TaggingPage;
```

---

### FILE: /src/pages/SharePage.jsx
// File: /src/pages/SharePage.jsx
// Purpose: Image sharing interface with tagged/untagged options (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';
import { useParams } from 'react-router-dom';

function SharePage() {
  const { sessionId } = useParams();

  return (
    <div className="max-w-4xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">
          üì§ Share Page
        </h1>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üîó</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Share Interface - Coming in Phase 4
          </h2>
          <p className="text-gray-500 mb-4">
            Session ID: <code className="bg-white px-2 py-1 rounded">{sessionId}</code>
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 4 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Share tagged or untagged versions</li>
            <li>Copy event comments</li>
            <li>Send to customer modal</li>
            <li>Watermark application</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default SharePage;
```

---

### FILE: /src/pages/GalleryPage.jsx
// File: /src/pages/GalleryPage.jsx
// Purpose: Main gallery view with session thumbnails (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';

function GalleryPage() {
  return (
    <div className="max-w-7xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <div className="flex items-center justify-between mb-6">
          <h1 className="text-3xl font-bold text-gray-800">
            üñºÔ∏è Gallery
          </h1>
          <button className="bg-primary text-white px-4 py-2 rounded-md hover:bg-blue-600">
            Refresh
          </button>
        </div>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üìÅ</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Gallery View - Coming in Phase 2
          </h2>
          <p className="text-gray-500">
            All uploaded sessions will appear here
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 2 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Thumbnail grid view</li>
            <li>Status badges (Raw, Tagged, Shared, Sent)</li>
            <li>Search and filter functionality</li>
            <li>Click to open SharePage</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default GalleryPage;
```

---

### FILE: /src/pages/CRMPage.jsx
// File: /src/pages/CRMPage.jsx
// Purpose: Customer relationship management interface (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';

function CRMPage() {
  return (
    <div className="max-w-7xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <div className="flex items-center justify-between mb-6">
          <h1 className="text-3xl font-bold text-gray-800">
            üë• Customer Management
          </h1>
          <button className="bg-primary text-white px-4 py-2 rounded-md hover:bg-blue-600">
            Add Customer
          </button>
        </div>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üìä</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            CRM Interface - Coming in Phase 5
          </h2>
          <p className="text-gray-500">
            Manage customers and delivery history
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 5 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Customer table with search and filters</li>
            <li>Delivery history tracking</li>
            <li>CSV export functionality</li>
            <li>Customer status management</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default CRMPage;
```

---

### FILE: /src/pages/SettingsPage.jsx
// File: /src/pages/SettingsPage.jsx
// Purpose: App settings and configuration (placeholder)
// Connects to: database.js, debugger.js

```javascript
import React from 'react';

function SettingsPage() {
  return (
    <div className="max-w-4xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">
          ‚öôÔ∏è Settings
        </h1>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üîß</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Settings Panel - Coming in Phase 5
          </h2>
          <p className="text-gray-500">
            Configure event details and preferences
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">Phase 5 will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Event name and hashtag configuration</li>
            <li>Message template editor</li>
            <li>Delivery preferences</li>
            <li>Export/import settings</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default SettingsPage;
```

---

### FILE: /src/pages/DebugPage.jsx
// File: /src/pages/DebugPage.jsx
// Purpose: Full-screen debug dashboard (alternative to overlay)
// Connects to: debugger.js, DebugConsole.jsx

```javascript
import React from 'react';
import { useNavigate } from 'react-router-dom';

function DebugPage() {
  const navigate = useNavigate();

  return (
    <div className="max-w-7xl mx-auto">
      <div className="bg-white rounded-lg shadow-md p-8">
        <div className="flex items-center justify-between mb-6">
          <h1 className="text-3xl font-bold text-gray-800">
            üêõ Debug Dashboard
          </h1>
          <button
            onClick={() => navigate('/gallery')}
            className="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700"
          >
            Back to Gallery
          </button>
        </div>
        
        <div className="bg-gray-100 rounded-lg p-12 text-center">
          <div className="text-6xl mb-4">üìä</div>
          <h2 className="text-xl font-semibold text-gray-700 mb-2">
            Debug Dashboard - Coming in Phase 2
          </h2>
          <p className="text-gray-500">
            Use the floating Debug Console (top nav) for now
          </p>
        </div>
        
        <div className="mt-6 text-sm text-gray-600">
          <p className="font-semibold mb-2">This page will include:</p>
          <ul className="list-disc list-inside space-y-1">
            <li>Performance metrics and charts</li>
            <li>Database statistics</li>
            <li>Error tracking and alerts</li>
            <li>System health monitoring</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

export default DebugPage;
```

---

### FILE: /.gitignore
// File: /.gitignore
// Purpose: Git ignore rules for node_modules, build files, and environment variables
// Connects to: Version control

```
# Dependencies
node_modules/
.pnp
.pnp.js

# Testing
coverage/

# Production
dist/
build/

# Environment
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# Logs
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

# Editor
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Debug logs
debug-logs/
*.log.txt
```

---

### FILE: /README.md
// File: /README.md
// Purpose: Project documentation and setup instructions
// Connects to: All project files

```markdown
# PMC Revamp - Photo Tagging & Delivery System

A modern photo management system for event photographers to upload, tag, share, and deliver photos efficiently.

## üöÄ Phase 1: Foundation & Core Infrastructure

This phase establishes the foundational architecture:

- ‚úÖ React 18 + Vite setup
- ‚úÖ React Router v6 with all page routes
- ‚úÖ Dexie.js database schema
- ‚úÖ Debug system with real-time console
- ‚úÖ Tailwind CSS styling
- ‚úÖ Navigation and layout components

## üì¶ Installation

```bash
npm install
```

## üèÉ Development

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

## üèóÔ∏è Build

```bash
npm run build
```

## üß™ Debug Console

Press `Ctrl+Shift+D` or click the Debug button in the navigation to toggle the debug console.

## üìÅ Project Structure

```
/src
  /pages          - Page components (Upload, Tagging, Share, Gallery, etc.)
  /components     - Reusable UI components (Navigation, DebugConsole, etc.)
  /services       - Business logic (database.js, debugger.js)
  /hooks          - Custom React hooks (Phase 2+)
  /assets         - Static assets (Phase 2+)
  App.jsx         - Main app component with router
  main.jsx        - React entry point
  index.css       - Global styles and Tailwind
```

## üîÑ Next Phases

- **Phase 2:** Upload workflow + Gallery implementation
- **Phase 3:** Tagging interface with canvas
- **Phase 4:** Share functionality + Watermarking
- **Phase 5:** CRM + Delivery system
- **Phase 6:** Settings + Advanced features

## üìñ Documentation

See `Design & Page Flow Specification (v1)` for complete app blueprint.

## üêõ Debug Events

All operations are tracked via the debug system. Event types include:

- Upload: `UPLOAD_START`, `UPLOAD_SUCCESS`, `IMAGE_COMPRESSED`
- Tagging: `TAG_ADDED`, `TAG_MOVED`, `TAG_SAVED`
- Sharing: `SHARE_TAGGED`, `SHARE_UNTAGGED`, `WATERMARK_APPLIED`
- Gallery: `GALLERY_LOAD`, `SESSION_VIEWED`, `SESSION_DELETED`
- CRM: `CUSTOMER_UPDATED`, `CUSTOMER_DELIVERED`
- Delivery: `DELIVERY_QUEUED`, `DELIVERY_SUCCESS`, `DELIVERY_FAIL`

## üìÑ License

Private project - All rights reserved
```

---

## üìã SUMMARY OF CREATED FILES

### Configuration Files (7)
1. `/package.json` - Project dependencies and scripts
2. `/vite.config.js` - Vite build configuration
3. `/tailwind.config.js` - Tailwind CSS theme
4. `/postcss.config.js` - PostCSS plugins
5. `/index.html` - HTML entry point
6. `/.gitignore` - Git ignore rules
7. `/README.md` - Project documentation

### Core Application Files (2)
8. `/src/main.jsx` - React entry point
9. `/src/App.jsx` - Root component with router setup

### Services & Utilities (3)
10. `/src/services/constants.js` - App-wide constants and event types
11. `/src/services/database.js` - Dexie database schema and CRUD operations
12. `/src/services/debugger.js` - Debug logging system

### Layout & Components (3)
13. `/src/components/Layout.jsx` - Main layout wrapper
14. `/src/components/Navigation.jsx` - Top navigation bar
15. `/src/components/DebugConsole.jsx` - Debug overlay component

### Page Components (7)
16. `/src/pages/UploadPage.jsx` - Upload interface (placeholder)
17. `/src/pages/TaggingPage.jsx` - Tagging interface (placeholder)
18. `/src/pages/SharePage.jsx` - Share interface (placeholder)
19. `/src/pages/GalleryPage.jsx` - Gallery view (placeholder)
20. `/src/pages/CRMPage.jsx` - CRM interface (placeholder)
21. `/src/pages/SettingsPage.jsx` - Settings page (placeholder)
22. `/src/pages/DebugPage.jsx` - Debug dashboard (placeholder)

### Styling (1)
23. `/src/index.css` - Global styles and Tailwind directives

---

## ‚úÖ PHASE 1 DELIVERABLES COMPLETE

**Total Files Created:** 23

**Features Implemented:**
- ‚úÖ Complete Vite + React 18 project setup
- ‚úÖ React Router v6 with 7 routes configured
- ‚úÖ Dexie database with 5 tables (sessions, tags_meta, customers, delivery_queue, settings)
- ‚úÖ Comprehensive debug system with 40+ event types
- ‚úÖ Real-time debug console with filtering and export
- ‚úÖ Tailwind CSS integration
- ‚úÖ Navigation system with active route highlighting
- ‚úÖ All page placeholders with phase roadmap info
- ‚úÖ Full CRUD operations for database
- ‚úÖ Keyboard shortcuts (Ctrl+Shift+D for debug toggle)

**Ready for Phase 2:** Upload workflow and Gallery implementation

---

## üéØ NEXT STEPS

1. **User:** Review this `phase1_claude_build.txt` file
2. **Send to Gemini:** For technical review and validation
3. **Send to ChatGPT:** For approval and final prompt generation
4. **Send to Grok:** For local file creation in Cursor
5. **Test:** Run `npm install` and `npm run dev`
6. **Proceed:** Phase 2 build after Phase 1 verification

**End of Phase 1 Build Document**